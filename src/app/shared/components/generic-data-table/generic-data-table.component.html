<bsc-table-toolbar
    [title]="config.title || 'Lista'"
    (export)="exportCSV()"
    (add)="create.emit('add')"
/>

<p-table
    #dt
    [value]="data"
    [rows]="config.rows || 10"
    [lazy]="true"
    [paginator]="true"
    [rowsPerPageOptions]="config.rowsPerPageOptions || [10, 20, 30]"
    [globalFilterFields]="config.globalFilterFields || []"
    (onLazyLoad)="onLazyLoad($event)"
    [tableStyle]="{ 'min-width': '75rem' }"
    [rowHover]="true"
>
    <ng-template pTemplate="caption">
        <div class="flex justify-between items-center">
            <h5 class="m-0">{{ config.title }}</h5>
            <div class="flex gap-2">
                <p-button
                    icon="pi pi-refresh"
                    pTooltip="Refrescar"
                    tooltipPosition="bottom"
                    (onClick)="getData()"
                />
                <p-iconfield>
                    <p-inputicon styleClass="pi pi-search" />
                    <input
                        pInputText
                        type="text"
                        (input)="globalFilter($event)"
                        placeholder="Buscar..."
                    />
                </p-iconfield>
            </div>
        </div>
    </ng-template>

    <ng-template pTemplate="header">
        <tr>
            <th *ngIf="config.actions?.length"></th>
            <th
                *ngFor="let col of config.columns"
                [pSortableColumn]="col.sortable ? col.field : undefined"
            >
                {{ col.header }}
                <p-sortIcon *ngIf="col.sortable" [field]="col.field" />
            </th>
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row>
        <tr>
            <td *ngIf="config.actions?.length">
                <bsc-table-actions [row]="row" [actions]="config.actions!" />
            </td>
            <td *ngFor="let col of config.columns">
                <ng-container *ngIf="col.badge; else otherCases">
                    <ng-template [bscStatusBadge]="row[col.field]" let-badge>
                        <span [ngClass]="badge.class">{{ badge.text }}</span>
                    </ng-template>
                </ng-container>

                <ng-template #otherCases>
                    <ng-container *ngIf="col.currency; else maybeDate">
                        <ng-template [bscCurrency]="row[col.field]" let-val>{{
                            val
                        }}</ng-template>
                    </ng-container>

                    <ng-template #maybeDate>
                        <ng-container *ngIf="col.date; else plain">
                            <ng-template
                                [bscFormatDate]="row[col.field]"
                                let-val
                                >{{ val }}</ng-template
                            >
                        </ng-container>
                    </ng-template>

                    <ng-template #plain>{{ row[col.field] }}</ng-template>
                </ng-template>
            </td>
        </tr>
    </ng-template>
</p-table>
